{{!--
  DCC Custom Class Sheet â€” Custom Class tab template
  Uses DCC system's skill list structure for each group
  Context passed from custom-sheet.js:
    tabLabel: string
    groups: [
      {
        className: string,
        skills: [Item] (full skill items)
      }
    ]
    hasGroups: boolean
--}}

<section class="tab ccc-wrap" data-group="sheet" data-tab="customClass">
  {{#if hasGroups}}
    {{#each groups as |group|}}
      <div class="box-title">{{group.className}}</div>
      <ol class="skill-list box-border">
        <li class="item-list-header grid-col-span-6">
          <div></div>
          <div class="skill-name">{{localize "DCC.SkillName"}}</div>
          <div class="skill-die">{{localize "DCC.SkillDie"}}</div>
          <div class="skill-modifier">{{localize "DCC.SkillValue"}}</div>
          <div class="skill-last-roll">{{localize "DCC.SkillResult"}}</div>
          <div></div>
        </li>
        {{#each group.skills as |skill id|}}
          <li class="item skill grid-col-span-6{{#if skill.item.system.description.summary}} skill-with-summary{{/if}}" data-item-id="{{skill.item._id}}"
              data-skill="{{skill.item.name}}">
            <div class="skill-check rollable" data-action="rollSkillCheck" data-drag="true" data-drag-action="skill">
              <img src="{{skill.item.img}}" alt="{{skill.displayName}}" title="{{skill.displayName}}" width="24" height="24"/>
            </div>
            <label class="skill-check skill-name rollable" data-action="postSkillToChat" data-item-id="{{skill.item._id}}" data-drag="true" data-drag-action="skill" data-tooltip="{{skill.tooltipContent}}">{{skill.displayName}}</label>
            <div>
              {{#if skill.item.system.config.useDie}}
                {{#if skill.item.system.die}}
                  {{skill.item.system.die}}
                {{else}}
                  --
                {{/if}}
              {{else}}
                --
              {{/if}}
            </div>
            <div class="skill-field">
              {{#if skill.item.system.config.useValue}}
                {{#if (and skill.item.system.ability skill.item.system.value)}}
                  {{#if (eq skill.item.system.ability "str")}}{{localize "DCC.AbilityStrShort"}}{{else if (eq skill.item.system.ability "agl")}}{{localize
                    "DCC.AbilityAglShort"}}{{else if (eq skill.item.system.ability "sta")}}{{localize
                    "DCC.AbilityStaShort"}}{{else if (eq skill.item.system.ability "per")}}{{localize
                    "DCC.AbilityPerShort"}}{{else if (eq skill.item.system.ability "int")}}{{localize
                    "DCC.AbilityIntShort"}}{{else if (eq skill.item.system.ability "lck")}}{{localize "DCC.AbilityLckShort"}}{{/if}} {{numberFormat
                  skill.item.system.value decimals=0 sign=true}}
                {{else if skill.item.system.ability}}
                  {{#if (eq skill.item.system.ability "str")}}{{localize "DCC.AbilityStrShort"}}{{else if (eq skill.item.system.ability "agl")}}{{localize
                    "DCC.AbilityAglShort"}}{{else if (eq skill.item.system.ability "sta")}}{{localize
                    "DCC.AbilityStaShort"}}{{else if (eq skill.item.system.ability "per")}}{{localize
                    "DCC.AbilityPerShort"}}{{else if (eq skill.item.system.ability "int")}}{{localize
                    "DCC.AbilityIntShort"}}{{else if (eq skill.item.system.ability "lck")}}{{localize "DCC.AbilityLckShort"}}{{/if}}
                {{else if skill.item.system.value}}
                  {{numberFormat skill.item.system.value decimals=0 sign=true}}
                {{else unless skill.item.system.config.useLevel}}
                  --
                {{/if}}
              {{else}}
                --
              {{/if}}
              {{#if skill.item.system.config.useLevel}}
                <span title="{{localize 'DCC.SkillUseLevelHint'}}">+{{actor.system.details.level.value}}</span>
              {{/if}}
            </div>
            <div>
              {{#if skill.item.system.config.showLastResult}}
                <label>{{skill.item.system.lastResult}}</label>
              {{else}}
                --
              {{/if}}
            </div>
            <div>
              <a class="item-edit" title="{{localize 'DCC.ItemEdit'}}" data-action="itemEdit" data-item-id="{{skill.item._id}}"><i class="fas fa-edit"></i></a>
              <a class="item-delete" title="{{localize 'DCC.ItemDelete'}}" data-action="itemDelete" data-item-id="{{skill.item._id}}"><i
                class="fas fa-trash"></i></a>
            </div>
            {{#if (and skill.item.system.config.useSummary skill.item.system.description.summary)}}
              <div class="skill-summary-text">
                {{skill.item.system.description.summary}}
              </div>
            {{/if}}
          </li>
        {{/each}}
      </ol>
    {{/each}}
  {{else}}
    <div class="ccc-empty">
      <p><em>{{localize 'DCCCS.Empty.Title'}}</em></p>
      
      <div class="ccc-empty-actions">
        <button type="button" class="ccc-btn ccc-builder-launch" data-action="launchBuilder">
          <i class="fa-solid fa-wand-sparkles"></i>
          {{localize 'DCCCS.LaunchBuilder'}}
        </button>
      </div>

      <details class="ccc-manual-instructions">
        <summary>{{localize 'DCCCS.ManualSetup'}}</summary>
        <ul>
          <li>{{localize 'DCCCS.Empty.Hint1'}}</li>
          <li>{{localize 'DCCCS.Empty.Hint2'}}</li>
          <li>{{localize 'DCCCS.Empty.Hint3'}}</li>
          <li>{{localize 'DCCCS.Empty.Hint4'}}</li>
        </ul>
      </details>
    </div>
  {{/if}}
</section>